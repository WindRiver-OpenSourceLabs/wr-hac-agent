<!DOCTYPE html>
<html>
<style>

#pinCodeProgress {
  width: 100%;
  height: 10px;
  position: relative;
  border: 1px solid #ccc;
}
#pinCodeBar {
  width: 10px;
  height: 100%;
  position: absolute;
  background-color: green;
}
</style>

<title>Board Registration</title>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="http://www.w3schools.com/lib/w3.css">
<link rel="stylesheet" href=
     "http://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.4.0/css/font-awesome.min.css">

<script type="text/javascript" src="scripts/register.js"></script>
<script type="text/javascript" src="scripts/associateid.js"></script>
<script type="text/javascript" src="scripts/pincode.js"></script>
<script type="text/javascript" src="scripts/createdevice.js"></script>
</head>

<body onload="loadStatusTbl()">


<!-- 
      Modal dialog box to perform Device Registration 

      Collect the username, password, desired device name, and, and
      SOCKS5 proxy (optional).  Call the client side JS function to do 
      the work.      
 -->

 <div id="regDeviceDialog" class="w3-modal"">
  <div class="w3-modal-content  w3-card w3-light-grey" style="width:500px" >

    <header class="w3-container w3-red"> 
      <span onclick="hideRegisterDeviceDialog()" 
      class="w3-closebtn">&times;</span>
      <h3>Create a New Device
       </h3>
    </header>

    <div class="w3-container">
      <p>Create a new device in your Helix App Cloud Workspace by entering your user 
       credentials and the desired name for this board. You can also specify a SOCKS5
       proxy if necessary.
      </p>  

      <form class="w3-form">
        <pre></pre>
        <input class="w3-input" id="regDeviceUserName" style="width:100%" type="email" 
          title="Enter your Helix App Cloud user name (required)" required>
          <label class="w3-label w3-validate">User Name</label>
        </input> 
        <input class="w3-input" id="regDevicePassword" style="width:100%" type="password"
          title="Enter your Helix App Cloud password (required). Note this will never be saved"  
          required>
          <label class="w3-label w3-validate">Password</label>
        </input>
        <input class="w3-input" id="regDeviceName" style="width:100%" type="text"
          title="Enter a name for this device in your Helix App Cloud Workspace (required)" 
         required>
         <label class="w3-label w3-validate">Device Name</label>
        </input>
        <input class="w3-input" id="regDeviceProxyURL" style="width:100%" 
          title="Enter a SOCKS5 proxy using the form hostname:port if necessary (optional)"
          type="text">
          <label class="w3-label w3-validate">Target Agent SOCKS5 Proxy</label>
        </input>
         
        <pre> 
        </pre>
                
        <input class="w3-btn w3-black" type="button" onclick="doRegisterDevice()" 
               title="Create the device in your Helix App Cloud Workspace"
               value="Register"></input>
        
        
         <br><br>
      </form>
    </div>    
  </div>
</div>



<!-- 
     Modal dialog box to get a Registration PIN Code from the server
     
     Collect a Device Name and proxy URL. Call the client side JS function  
    to do the work
-->
<div id="genPinCodeDialog" class="w3-modal">
  <div class="w3-modal-content w3-card-8 w3-light-grey" style="width:500px">
    <header class="w3-container w3-red"> 
      <span onclick="hidePinCodeDialog()" 
      class="w3-closebtn">&times;</span>
      <h2>Generate a PIN Code
       </h2>
    </header>
    <div class="w3-container">
      <p>Generate a unique PIN code which you can use to create a new device in your
         Helix App Cloud Workspace for this board.  You must specify the name for the 
         device.  You can also specify a SOCKS5 proxy if necessary.
      </p> 
      
      <form class="w3-form">
      <input class="w3-input" id="pinCodeDeviceName" style="width:100%" type="text" required
          title="Enter a name for this device in your Helix App Cloud Workspace (required)">      
          <label class="w3-label w3-validate">Device Name</label>
      </input>
      <input class="w3-input" id="pinCodeProxyURL" style="width:100%" type="text"
          title="Enter a SOCKS5 proxy using the form hostname:port if necessary (optional)">
          <label class="w3-label w3-validate">Target Agent SOCKS5 Proxy</label>
      </input>

      <!-- Stuff to disply Registration Token -->
      <p id="pinCodeInstruction" style="visibility:hidden;" align="center" 
          >Use the PIN Code below to create a New Device in Helix App Cloud</p>
      <h2 id="pinCodeValue" style="visibility:hidden" align="center" w3-black>
      	  <mark>INVALID</mark></h2>

      <div id="pinCodeProgress" style="width:100%; visibility:hidden">
      <div id="pinCodeBar"></div>
      </div>
      <pre> </pre>
      
      <!-- Action buttons -->
      <input class="w3-btn w3-black" type="button" Value="Get PIN"
             id="pinCodeGetButton" onclick="doGetPinCode()"
             title="Get a Registration Token for this board"></input>
      <input class="w3-btn w3-black" type="button" id="pinCodeUsedButton"
      		  style="visibility:hidden" Value="Device Created" 
      		  onclick="doPinCodeUsed()"
      		  title="Acknowledge using this Registration Token"></input>
      <input class="w3-btn w3-red" type="button" id="pinCodeCancelButton"
              style="visibility:hidden" Value="Cancel"
              onclick="doPinCodeCancel()"
              title="Discard this Registration Token"></input>
      <br><br>
      </form>
    </div>
  </div>
</div>

<!-- 
      Modal dialog box to associate the device with a pre-exiting
      Device ID on the Helix App Cloud server 

      Collect the device ID and SOCKS5 proxy. Call the client side JS function
      to do the work.      
 -->

 <div id="associateDevDialog" class="w3-modal"">
  <div class="w3-modal-content  w3-card w3-light-grey" style="width:500px" >
    <header class="w3-container w3-red"> 
    <span onclick="hideAssociateDevDialog()" 
      class="w3-closebtn">&times;</span>
      <h3>Associate Board with a Device ID
       </h3>
    </header>
    <div class="w3-container">
      <p>Associate this board with an existing Device in your Helix App Cloud 
         Workspace using its Device ID.  Copy the Device ID from the Helix App
         Cloud and paste it below.</p>  
      <form class="w3-form">
        <pre></pre>
        <input class="w3-input" id="associateDevID" style="width:100%" type="text" 
           title="Specify the Device ID you wish to associate with (required)" 
           required>
           <label class="w3-label w3-validate">Device ID</label>
         </input> 
        <input class="w3-input" id="associateDevServer" style="width:100%" type="text"
           title="Specify the adddress of the Helix App Cloud Server (optional)">
           <label class="w3-label w3-validate">Server Address</label>
        </input>
        <input class="w3-input" id="associateDevProxy" style="width:100%" 
           title="Enter a SOCKS5 proxy using the form hostname:port if necessary (optional)"
           type="text">
           <label class="w3-label w3-validate">Target Agent SOCKS5 Proxy</label>
        </input>
         
        <pre> 
        </pre>
        <input class="w3-btn w3-black" type="button" onclick="doAssociateDevWithID()"
               title="Perform association of this board with the specified Device ID"
               value="Associate" ></input>
         <br><br>
      </form>
    </div>    
  </div>
</div>



<!-- 
     Modal dialog box to get a Proxy setting for registration
     
     Collect a Proxy URL and call the client side JS function to 
     perfrom the server request
-->

<div id="httpsProxyDialog" class="w3-modal">
  <div class="w3-modal-content w3-card-8 w3-light-grey" style="width:500px">
    <header class="w3-container w3-red"> 
      <span onclick="hideHttpsProxyDialog()" 
      class="w3-closebtn">&times;</span>
      <h2>Set Proxy Server
       </h2>
    </header>
    <div class="w3-container">
      <p>Enter a URL to a HTTPS proxy server used to carry out device registration 
      operations. (optional)</p> 
      <form class="w3-form">
      <input class="w3-input" id="httpsProxyURL" style="width:100%" type="url"
          title="Enter the URL of your Proxy Server. IE: https://proxy.mycompany.com:3128"
          required>
          <label class="w3-label w3-validate">Proxy Server URL</label>
      </input>
        <pre> 
        </pre>
        <input class="w3-btn w3-black" type="button" onclick="doSetHttpsProxy()"
               value="Set Proxy" ></input>
         <br><br>
      </form>
    </div>    
  </div>
</div>



<!-- End of Modal Dialog definitions -->
<!-- Begin visible stuff on page load -->

<!-- Create a Navigation Bar across top of viewport -->
<nav class="w3-topnav w3-black w3-large" >
  <i class="fa fa-refresh" id="idRefresh" onclick="loadStatusTbl()"></i></a>
  <div class="w3-dropdown-hover">
    <button class="w3-btn w3-medium">Register Device</button>
      <div class="w3-dropdown-content">
        <a onclick="showRegisterDeviceDialog()" class="w3-btn w3-left-align w3-medium">Create Device</a>
        <a onclick="showPinCodeDialog()" class="w3-btn w3-left-align w3-medium">Generate PIN</a>
        <a onclick="showAssociateByIdDialog()" class="w3-btn w3-left-align w3-medium">Associate Device</a>
       </div>
    </div>
  <button onclick="doResetDevice()" class="w3-btn w3-medium">Reset Device</button>
  <button onclick="doRestoreDevice()" class="w3-btn w3-medium">Restore Device</button>
  <div class="w3-dropdown-hover">
    <button class="w3-btn w3-medium">Utilities</button>
      <div class="w3-dropdown-content">
        <a onclick="showHttpsProxyDialog()" class="w3-btn w3-left-align w3-medium">Manage Proxy</a>
        <a onclick="toggleAdvanced()" class="w3-btn w3-left-align w3-medium">Toggle Advanced</a>
       </div>
    </div>	
</nav>


<!--
  Display current registration status.  The initial table is built in the 
  div with default values.  To update the table call loadStatusTbl() from JS.
  It will get the data from the server side and update the table.
-->


 <header class="w3-container w3-red"><h3>Device Status</h3></header>

  <table id="devStat" class="w3-table w3-hoverable" >
    <tbody style="text-align:left;">
      <tr >
         <td title="The name of this board in your Helix App Cloud Workspace">
          Device Name</td>
         <td id="devStatName">-------------</td>
      </tr>
      <tr>
         <td title="The unique ID of this board in your Helix App Cloud Workspace">
             Device ID</td>
         <td id="devStatID">-------------</td>
     </tr>
     <tr>
         <td title="IP address or FQDN of the Helix Server this board is configure to work with">
             Server</td>
         <td id="devStatServer">-------------</td>
     </tr>
      <tr>
         <td title="TCP/IP port number used to communicate with the Helix App Cloud Server">
             Server Port</td>
         <td id="devStatPort">-------------</td>
     </tr>
     <tr>
         <td title="SOCKS5 Proxy used by the Helix Target Agent to comunicate with the Helix App Cloud Server">
             Target  Proxy</td>
         <td id="devStatAgentProxy">-------------</td>
     </tr>
     <tr>
         <td title="Board registration status">Status</td>
         <td id="devStatRegistered">-------------</td>
     </tr>
     <tr id="displayDfltServer" style="visibility:hidden">
         <td title="Default Helix App Cloud server configured for this board">
             Default Server</td>
         <td id="devStatDfltServer">-------------</td>
     </tr>
     <tr id="displayHttpsProxy" style="visibility:hidden">
         <td title="HTTPS proxy used to conduct registration operations">
             HTTPS Proxy</td>
         <td id="devStatHttpsProxy">-------------</td>
     </tr>
     <tr id="displaySDKName" style="visibility:hidden">
         <td title="Name of the runtime software package on this board">
             SDK Name</td>
         <td id="devStatSDKName">-------------</td>
     </tr>
     <tr id="displaySDKVersion" style="visibility:hidden">
         <td title="Version of the runtime software package on this board">
             SDK Version</td>
         <td id="devStatSDKVersion">-------------</td>
     </tr>
    </tbody>
  </table>
  

<!-- End visible stuff on page load -->
